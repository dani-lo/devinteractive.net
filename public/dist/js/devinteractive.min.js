angular.module("DevInt",["ngRoute","angularModalService","DevInt.controllers","DevInt.filters","DevInt.services","DevInt.directives"]).config(["$routeProvider","$locationProvider",function(a,b){"use strict";a.when("/app/home",{templateUrl:"partials/home",controller:"HomeCtrl"}).when("/app/jobs",{templateUrl:"partials/jobs",controller:"JobsCtrl"}).when("/app/experience",{templateUrl:"partials/cv",controller:"CvCtrl"}).when("/login",{}).otherwise({redirectTo:"/app/home"}),b.html5Mode(!0)}]).constant("APPCONFIG",{version:"0.1",imgBase:"/img",imgExtension:".png",fetchTimeout:2e4,endpoints:{jobs:{list:"/api/jobs",type:"GET"},user:{login:"/login/local",type:"POST"},images:{list:"/api/images",type:"GET"},experience:{list:"/api/experience",type:"GET"}}}),angular.module("DevInt.controllers",[]).controller("HomeCtrl",["$scope",function(a){"use strict";a.isloading=!0,a.isready=!1,a.isdone=!1,setTimeout(function(){a.isready=!0,a.isloading=!1,a.$apply(),setTimeout(function(){a.isdone=!0,a.$apply()},1e3)},1e3)}]).controller("JobsCtrl",["$scope","$window","$timeout","JobsDataService","APPCONFIG","JobsImagesService","UserMsgService",function(a,b,c,d,e,f,g){"use strict";var h=this;this.imagesloaded=0,this.totalImages=0,this.loaderwidth=0,a.jobs=[],a.isloading=!0,a.loaderw=0,a.cmsactive=!1,a.calcImageLoadingStep=function(a){h.loaderwidth=a},this.imageloaded=function(){h.imagesloaded++,a.loaderw=h.loaderwidth/h.totalImages*h.imagesloaded,h.imagesloaded===h.totalImages&&setTimeout(function(){a.isloading=!1,a.$apply(),setTimeout(function(){a.isdone=!0,a.$apply()},1e3)},500)},this.getJobs=function(){d.getJobs().then(function(b){a.jobs=b.data;for(var c=0;c<b.data.length;c++)h.totalImages+=b.data[c].images,h.preloadImages(b.data[c].alias,b.data[c].images)})},this.preloadImages=function(a,b){for(var c=1;b>=c;c++)f.preloadImage(a,c).then(h.imageloaded)},this.getJobs(),a.menu=!1,a.showMenu=function(){a.menu=!0},a.hideMenu=function(){a.menu=!1,a.cmsactive=!1},a.logout=function(){g.showMsg("You are being redirected","Good bye!","success","flash-show"),c(function(){b.location.href="/logout"},2e3)},a.cms=function(){a.cmsactive=a.cmsactive?!1:!0,a.cmsactive===!0&&g.showMsg("You will not be ble to add users","Permissions error","fail","flash-show")}}]).controller("AccountCtrl",["$scope","$timeout","$window","APPCONFIG","UserAccountService","UserMsgService",function(a,b,c,d,e,f){"use strict";var g=this;a.loggedin=!1,a.ready=!1,a.user={email:"",password:""},b(function(){a.ready=!0,a.$apply()},500),a.postLogin=function(){g.postLogin()},this.postLogin=function(){e.userLogin(a.user).then(function(d){var e=d.data;"success"===e.status?(f.showMsg("Login successsful, you are now being redirected","Login Success","success","flash-show"),a.ready=!1,b(function(){c.location.href="/app/home"},2e3)):(f.showMsg(e.text,"Login Error","fail","flash-show"),g.resetLoginForm())})},this.resetLoginForm=function(){angular.copy({},a.user),a.loginlocal.$setPristine(),a.loginlocal.$setUntouched();var b=a.$root.$$phase;"$apply"!==b&&"$digest"!==b&&a.$apply()}}]).controller("CvCtrl",["$scope","$timeout","$window","CvDataService","UserMsgService",function(a,b,c,d,e){"use strict";a.experience=[],a.isloading=!0,a.cmsactive=!1,a.menu=!1,a.isactivepos=!1,a.currpos={cdesc:"",cname:"",date:"",description:[],tech:"",title:"",urls:[]},a.showMenu=function(){a.menu=!0},a.hideMenu=function(){a.menu=!1,a.cmsactive=!1},a.logout=function(){e.showMsg("You are being redirected","Good bye!","success","flash-show"),b(function(){c.location.href="/logout"},2e3)},a.cms=function(){a.cmsactive=a.cmsactive?!1:!0,a.cmsactive===!0&&e.showMsg("You will not be ble to add users","Permissions error","fail","flash-show")},a.showPos=function(b){a.currpos=a.experience.filter(function(a){return a._id===b})[0],console.log(a.currpos),a.isactivepos=!0},a.hidePos=function(){a.isactivepos=!1},this.getCv=function(){d.getExperience().then(function(c){a.experience=c.data,b(function(){a.isloading=!1,b(function(){a.uiready=!0},200)},500)})},this.getCv()}]),angular.module("DevInt.directives",[]).directive("devintImageCaro",["$timeout",function(a){"use strict";return{restrict:"A",scope:!1,link:function(b,c,d){function e(){f.removeClass("curr"),a(function(){f.attr("src",g+i+".png")},250),a(function(){f.addClass("curr")},500)}var f,g,h,i;i=1,c.find("i.fa-angle-left").bind("click",function(a){i-1===0?i=h:i-=1,e()}),c.find("i.fa-angle-right").bind("click",function(a){i+1>h?i=1:i+=1,e()}),b.$watch("isloading",function(){b.isloading===!1&&(g=c.data("imgbase"),h=c.data("imgset"),f=c.find(".work-img-set img"))})}}}]).directive("devintImageLoad",function(){"use strict";return{scope:!1,link:function(a,b,c){a.calcImageLoadingStep(b.width()),a.$watch("loaderw",function(a){b.find("#img-load-prog").width(a)})}}}).directive("devintScrollPosition",["$window",function(a){"use strict";return{link:function(b,c,d){var e=angular.element(a),f=0,g=0,h=function(){g=e.scrollTop(),f=e.height(),c.addClass("scrolled-nop"),g>f?c.addClass("scrolled-a"):c.removeClass("scrolled-a"),c.removeClass("scrolled-nop")};e.on("scroll",h),h()}}}]).directive("devintAffix",["$window",function(a){"use strict";return{link:function(b,c,d){var e=angular.element(a),f=0,g=0,h=function(){f=e.scrollTop(),g=e.height()/2,b.lastscroll>f?c.removeClass("affix"):f>g?c.addClass("affix"):c.removeClass("affix"),b.lastscroll=f};e.bind("scroll",h),h()}}}]).directive("devintEllipsis",function(){"use strict";return{restrict:"A",template:"<h4>{{}}</h4>",scope:{data:"="},link:function(a,b,c){var d=a.data;d.length>100?b.html(d.substring(0,100)+" ..."):b.html(d)}}}).directive("a",function(){"use strict";return{restrict:"E",link:function(a,b,c){"#_"===c.href&&b.on("click",function(a){a.preventDefault()})}}}).directive("devintSuggest",["$window","$timeout",function(a,b){"use strict";var c=!1;return{replace:!0,link:function(a,b,d){var e=b.find("span"),f=e.data("orient"),g=e.data("tip");e.html(g),e.addClass("orient-"+f),b.bind("mouseenter",function(){e.addClass("d-reveal"),c&&(clearTimeout(c),c=!1),c=setTimeout(function(){e.removeClass("d-reveal")},1500)}),b.bind("mouseleave",function(){e.removeClass("d-reveal")})}}}]),angular.module("DevInt.filters",[]).filter("interpolate",["APPCONFIG",function(a){"use strict";return function(b){return String(b).replace(/\%VERSION\%/gm,a.version)}}]),angular.module("DevInt.services",[]).factory("JobsDataService",["$http","APPCONFIG","ModalService",function(a,b,c){"use strict";return{getJobs:function(){return a.get(b.endpoints.jobs.list)}}}]).factory("CvDataService",["$http","APPCONFIG",function(a,b){"use strict";return{getExperience:function(){return a.get(b.endpoints.experience.list)}}}]).factory("JobsImagesService",["$q","APPCONFIG",function(a,b){"use strict";return{preloadImage:function(c,d){var e;return a(function(a,f){e=new Image,e.src=b.imgBase+"/"+c+"/"+d+b.imgExtension,e.onload=function(){a()},setTimeout(function(){f()},b.fetchTimeout)})}}}]).service("UserMsgService",["$window","ModalService","$timeout",function(a,b,c){"use strict";return{showMsg:function(d,e,f,g,h,i){e?b.showModal({template:"<div class='flash-msg {{msg.status}}'><div><h2>{{msg.title}}</h2><p>{{msg.message}}</p></div></div>",controller:["close",function(a){this.title=e,this.message=d,this.status=f||"success",c(function(){a("ok"),h&&h.scope&&h.call(i)},2e3)}],controllerAs:"msg"}).then(function(a){g&&c(function(){a.element.addClass(g)},250)}):a.alert(d)}}}]).service("UserAccountService",["$http","APPCONFIG",function(a,b){"use strict";return{userLogin:function(c){return a.post(b.endpoints.user.login,c)},userAdd:function(c){return a.post(b.endpoints.users.add,c)}}}]);